stages:
  - build

dev:
  stage: build
  image: docker:18.09.4
  only:
    - dev
  tags:
    - docker
  script:
    - docker build --build-arg VUE_BUILD_MODE=dev -t reg.paradise-soft.com.tw:5000/fileserver-spa:latest .
    - docker push reg.paradise-soft.com.tw:5000/fileserver-spa:latest

uat:
  stage: build
  image: docker:18.09.4
  only:
    - dev
  tags:
    - docker
  script:
    - docker build --build-arg VUE_BUILD_MODE=uat -t reg.paradise-soft.com.tw:5000/fileserver-spa:uat .
    - docker push reg.paradise-soft.com.tw:5000/fileserver-spa:uat

tags:
  stage: build
  image: docker:18.09.4
  only:
    - tags
  tags:
    - docker
  script:
    - docker build --build-arg VUE_BUILD_MODE=prod --build-arg VERSION=$CI_COMMIT_TAG --build-arg COMMITSHA=$CI_COMMIT_SHA -t reg.paradise-soft.com.tw:5000/fileserver-spa:$CI_COMMIT_TAG . 
    - docker push reg.paradise-soft.com.tw:5000/fileserver-spa:$CI_COMMIT_TAG

